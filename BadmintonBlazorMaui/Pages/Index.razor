@page "/"
@using Badminton.Shared.Classes

<div class="row h-100">
    <div class="col-8">
        <div class="row">
            <div class="col">
                <button type="button" class="btn btn-outline-secondary" @onclick="OnAddPlayer">Add Player</button>
                <button type="button" class="btn btn-outline-secondary" @onclick="OnRemovePlayer">Remove Player</button>
                <BSButton Color="BSColor.Primary" Target="modal1">Launch demo modal</BSButton>
            </div>
        </div>
        <div class="row mt-3">
            <div class="col">
                Waiting Players
            </div>
        </div>
    </div>
    <div class="col-4 h-100">
        <div class="d-flex flex-column h-100">
            @foreach (var match in _badmintonClub.CurrentSession.Matches)
            {
                <MatchDisplay Match="@match"></MatchDisplay>
            }
        </div>
    </div>
</div>

<div class="row">

</div>

<BSModal DataId="modal1">
    <Header>Modal Title</Header>
    <Content>Woohoo, you're reading this text in a modal!</Content>
    <Footer Context="modal">
        <BSButton MarginStart="Margins.Auto" Color="BSColor.Secondary" @onclick="modal.HideAsync">Close</BSButton>
        <BSButton Color="BSColor.Primary">Save changes</BSButton>
    </Footer>
</BSModal>

@code {
    private BadmintonClub _badmintonClub = new();

    public Index()
    {
        var loadedBadmintonClub = Badminton.Shared.Classes.BadmintonClub.Load
        (
            (badmintonClub, oldVersionNumber) =>
            {
                // TODO!
            }
        );

        _badmintonClub = loadedBadmintonClub ?? new();
    }

    void OnAddPlayer() {
        Console.WriteLine("clicked!");
        var match = new Match { CourtNumber = 1 };
        _badmintonClub.Sessions.Add(new Session(4));
        _badmintonClub.CurrentSession.Matches.Add(match); // TODO temp
    }

    void OnRemovePlayer()
    {
        Console.WriteLine("clicked!");
    }
}